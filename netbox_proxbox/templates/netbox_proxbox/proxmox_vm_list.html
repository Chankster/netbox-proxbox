{% extends 'proxbox_layout.html' %}
{% load render_table from django_tables2 %}

{% block content %}
    <div class="pull-right noprint">
        {% if perms.netbox_proxbox.add_proxmoxvm %}
        <a href="{% url 'plugins:netbox_proxbox:proxmoxvm_full_update' %}" target="_blank" class="btn btn-primary">Proxmox Full Update</a>
        {% endif %}
    </div>

    <h1>{% block title %}All Proxmox Virtual Machines (in Development, Wait!){% endblock %}</h1>
    <div class="row">
        <div class="col-md-9">
            <!-- 'render_table' is a template tag that comes from django_tables2 and renders HTML tables among other things-->
            {% render_table table %}
        </div>
        <!-- search panel div start -->
        <div class="col-md-3 noprint">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <span class="{{ icon_classes.search }}" aria-hidden="true"></span>
                    <strong>Search</strong>
                </div>
                <div class="panel-body">
                    <form action="." method="get" class="form">
                        <!-- Form fields are rendered in 'for' loop-->
                        {% for field in filter_form.visible_fields %}
                        <div class="form-group">
                            <!-- 
                                Only 'q' field receives special treatment, as it does not belong to any underlying model. 
                                We make it a text input field with label as a placeholder
                            -->
                            {% if field.name == "q" %}
                            <div class="input-group">
                                <!-- 
                                    Value of the field is carried over from previous search.
                                    It's usually done by auto-generated form fields, but in this case we have do it manually with the expression below
                                -->
                                <input type="text" name="q" class="form-control" placeholder="{{ field.label }}"
                                    {% if request.GET.q %}value="{{ request.GET.q }}" {% endif %} />
                                <span class="input-group-btn">
                                    <button type="submit" class="btn btn-primary">
                                        <span class="{{ icon_classes.search }}" aria-hidden="true"></span>
                                    </button>
                                </span>
                            </div>
                            <!-- fields are rendered with defaults settings-->
                            {% else %}
                            {{ field.label_tag }}
                            {{ field }}
                            {% endif %}
                        </div>
                        {% endfor %}
                        <div class="text-right noprint">
                            <button type="submit" class="btn btn-primary">
                                <span class="{{ icon_classes.search }}" aria-hidden="true"></span> Apply
                            </button>
                            <a href="." class="btn btn-default">
                                <span class="{{ icon_classes.remove }}" aria-hidden="true"></span> Clear
                            </a>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block footer_links %}
    {{ block.super }}

    {# Proxbox Custom Links #}
    <li class="nav-item dropdown dropup">
        <a type="button" class="nav-link dropdown-toggle text-primary" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            <i title="Proxbox Plugin" class="mdi mdi-puzzle" data-bs-placement="top" data-bs-toggle="tooltip"></i>
        </a>
        <ul class="dropdown-menu disabled" aria-labelledby="navbarDropdown">
            <li>
                {# Proxbox - Documentation #}
                <a type="button" class="dropdown-item" href="https://github.com/N-Multifibra/netbox-proxbox/blob/develop/README.md" target="_blank">
                    <i title="Proxbox | Docs" class="mdi mdi-book-open-variant text-primary" data-bs-placement="top" data-bs-toggle="tooltip"></i>  Docs
                </a>
            <li>
                {# Proxbox - GitHub #}
                <a type="button" class="dropdown-item" href="https://github.com/N-Multifibra/netbox-proxbox" target="_blank">
                    <i title="Proxbox | Source Code" class="mdi mdi-github text-primary" data-bs-placement="top" data-bs-toggle="tooltip"></i> GitHub
                </a>
            </li>
            <li>
                {# Proxbox - Telegram (Brazil) #}
                <a type="button" class="dropdown-item" href="https://t.me/netboxbr" target="_blank">
                    <i title="Proxbox | Telegram (Brazil)" class="mdi mdi-telegram text-primary" data-bs-placement="top" data-bs-toggle="tooltip"></i> Telegram (BR)
                </a>
            </li>
            <li>
                <hr class="dropdown-divider">
            </li>
            <li>
                <span class="dropdown-item disabled">Proxbox (v0.0.3)</span>
            </li>
        </ul>
    </li>
{% endblock %}