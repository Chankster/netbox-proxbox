{# Base layout for the core Proxbox w/navbar and page content #}
{% extends 'proxbox_layout.html' %}

{% block content %}
    <h2>Nodes</h2>
    <table class="table">
        <thead>
                <tr>
                    <th>Node status changed</th>
                    <th>Cluster changed</th>
                    <th>Update result</th>

                </tr>
        </thead>
        <tbody>
            {% for node in proxmox.nodes %}
            <tr>
                <td>{{ node.changes.status }}</td>
                <td>{{ node.changes.cluster }}</td>
                <td>{{ node.result }}</td>

            </tr>
            {% endfor %}
        </tbody>
    </table>

    <br><br>
    <h2>Virtual Machines and Containers</h2>

    <table class="table">
        <thead>
                <tr>
                    <th>VM/CT Name</th>
                    <th>Status changed</th>
                    <th>Custom Fields</th>
                    <th>Local context</th>
                    <th>Resources</th>
                    <th>Tag</th>
                    <th>Update result</th>
                </tr>
        </thead>
        <tbody>
            {% for virtualmachine in proxmox.virtualmachines %}
            <tr>
                <td><strong>{{ virtualmachine.name }}</strong></td>
                <td>{{ virtualmachine.changes.status }}</td>
                <td>{{ virtualmachine.changes.custom_fields }}</td>
                <td>{{ virtualmachine.changes.local_context }}</td>
                <td>{{ virtualmachine.changes.resources }}</td>
                <td>{{ virtualmachine.changes.tag }}</td>
                <td>{{ virtualmachine.result }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    <br><br>
    <h2>Remove unused VM/CT</h2>
    <h3>Logs:</h3>
    <ul>
    {% for deleted in proxmox.remove_unused %}
        
        {# Check amount of logs #}
        {% if deleted.log|length > 1 %}
            <li><strong>{{ deleted.name }}</strong>
                <ul>
                    {% for log in deleted.log %}
                        <li>{{ log }}</li>
                    {% endfor %}
                </ul>
            </li>
            
        {% else %}
            {# If only 01 log #}
            <li><strong>{{ deleted.name }}</strong> - {% for log in deleted.log %}{{ log }}{% endfor %}</li>
        {% endif %}
        

        
        <br>
    {% endfor %}
    </ul>
{% endblock %}

{% block footer_links %}
    {{ block.super }}

    {# Proxbox Custom Links #}
    <li class="nav-item dropdown dropup">
        <a type="button" class="nav-link dropdown-toggle text-primary" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            <i title="Proxbox Plugin" class="mdi mdi-puzzle" data-bs-placement="top" data-bs-toggle="tooltip"></i>
        </a>
        <ul class="dropdown-menu disabled" aria-labelledby="navbarDropdown">
            <li>
                {# Proxbox - Documentation #}
                <a type="button" class="dropdown-item" href="https://github.com/N-Multifibra/netbox-proxbox/blob/develop/README.md" target="_blank">
                    <i title="Proxbox | Docs" class="mdi mdi-book-open-variant text-primary" data-bs-placement="top" data-bs-toggle="tooltip"></i>  Docs
                </a>
            <li>
                {# Proxbox - GitHub #}
                <a type="button" class="dropdown-item" href="https://github.com/N-Multifibra/netbox-proxbox" target="_blank">
                    <i title="Proxbox | Source Code" class="mdi mdi-github text-primary" data-bs-placement="top" data-bs-toggle="tooltip"></i> GitHub
                </a>
            </li>
            <li>
                {# Proxbox - Telegram (Brazil) #}
                <a type="button" class="dropdown-item" href="https://t.me/netboxbr" target="_blank">
                    <i title="Proxbox | Telegram (Brazil)" class="mdi mdi-telegram text-primary" data-bs-placement="top" data-bs-toggle="tooltip"></i> Telegram (BR)
                </a>
            </li>
            <li>
                <hr class="dropdown-divider">
            </li>
            <li>
                <span class="dropdown-item disabled">Proxbox (v0.0.3)</span>
            </li>
        </ul>
    </li>
{% endblock %}